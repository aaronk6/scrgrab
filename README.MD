# SCRGRAB.EXE

**Utility for Windows 3.x that will take a screenshot and exit (no UI) – for use in conjunction with Windows httpd.**

`scrgrab.exe` is expected to be called via *cgi-win*. It will take a screenshot in BMP format, write it to `C:\HTTPD\HTDOCS\SCRGRAB.BMP` (hard-coded), and return a HTTP 302  response for the client to retrieve the image from `/scrgrab.bmp`.

You can see it live in action on **[win311.aaron.cc](https://win311.aaron.cc)** (or just scroll down to the bottom of this page).

## Usage

The following assumes you have *Windows httpd* set up correctly.

* Rename `PROJECT1.EXE` to `SCRGRAB.EXE`.
* Put `SCRGRAB.EXE` in `C:\HTTPD\HTDOCS\CGI-WIN`.

**You can now call http://example.com/cgi-win/scrgrab.exe to get a screenshot from your Windows box.** 

Note that example.com is a placeholder for the hostname or IP address of your web server.

(**TODO:** Rename files in the repository, so the resulting EXE file is already called `SCRGRAB.EXE`.)

## Arguments

Arguments according to *cgi-win* specification:

```
scrgrab.exe PROFILE INPUT_FILE OUTPUT_FILE
```

## Output

The following HTTP response will be written to `OUTPUT_FILE` where the webserver will pick it up and send it to the client. This will redirect the client to the freshly generated screenshot.

```
HTTP/1.0 302 Found
Location: /scrgrab.bmp
```

(**TODO:** Avoid redirect. Instead, write full HTTP response, including body, directly to OUTPUT_FILE.)

## Screenshot

This screenshot was actually generated by `scrgrab.exe`—just now!

<img src="https://test710.uber.space/cgi-win/scrgrab.exe" width="640" height="480" alt="">

